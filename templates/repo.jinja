<!-- 
    Knowledge Repository page to browse articles
-->
{% extends 'base.jinja' %}

{% block content %} 
<style>
    nav {
        border-bottom: 1px solid black;
        overflow: auto
    }

    main {
        display: flex;
        height: 100%;
    }

    .text  {
        margin-top: 2px;
        margin-bottom: 2px;
    }

</style>

<!-- Include navigation -->
{% include 'nav.jinja' %}

<div class="container">
    {% for messages in get_flashed_messages() %}
    <div class="alter alter-danger">{{ messages }}</div>
    {% endfor %}

    <h1 xmlns="http://www.w3.org/1999/html">{% block title %} Knowledge Repository {% endblock %}</h1>

    {% for post in posts %}
    <a href="{{url_for('post', post_id=post['id'])}}">
        <h2>{{ post['title'] }}</h2>
    </a>
    <div>
        <h3 style="display: inline; margin-right: 10px;">By {{ post['author'] }}</h3>
        <p style="display: inline;">{{ post['role'] }}</p>
    </div>

    <span class="badge badge-primary">{{ post['created'] }}</span>
    {% if username == post['author'] or role > 0 %}
    <a href="{{url_for('edit', post_id=post['id']) }}">
        <span class="badge badge-warning">edit</span>
    </a>
    {% endif %}

    <hr>
    {% endfor %}

</div>

<script>
    $(document).ready(() => {
        let username = localStorage.getItem("username");
        let roleNum = parseInt(sessionStorage.getItem("role"));
    })
</script>

{% endblock %}
