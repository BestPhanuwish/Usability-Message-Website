{% extends 'base.jinja' %}

<!-- Include navigation -->
{% include 'nav.jinja' %}

{% block content %}
<h1>{% block title %} {{ post['title'] }} {% endblock %}</h1>
<span class="badge badge-primary">{{ post['created'] }}</span>
<div>
        <h3 style="display: inline; margin-right: 10px;">By {{ post['author'] }}</h3>
        <p style="display: inline;">
            {% if post['role'] == '0' %}
                student
            {% elif post['role'] == '1' %}
                staff
            {% elif post['role'] == '2' %}
                administrator
            {% elif post['role'] == '3' %}
                admin
            {% else %}
                Unknown Role
            {% endif %}
        </p>
    </div>
<hr>

<p>{{post['content']}}</p>

<br>

{% if username == post['author'] %}
<form action="{{ url_for('delete', post_id=post['id']) }}" method="POST">
    <input type="submit" value="delete" class="bttn btn-danger btn-sm"
           onclick="return confirm('Do you confirm to delete?')">
</form>
{% endif %}

<form method="post" action="{{ url_for('make_comment', post_id=post['id']) }}">
    <div class="form-group">
        <label for="comment">Create Comment</label>
        <textarea name="comment" placeholder="Type your comment" class="form-control">{{ request.form.get('comment', '') }}</textarea>
    </div>
    <div class="form-group">
        <button type="submit" class="btn btn-primary">Submit</button>
    </div>
</form>


<h3>Comments</h3>
{% if comments %}

    {% for comment in comments %}
        <div class="comment">
            <p>{{ comment['body'] }} </p>
            <p>{{ comment['created'] }}</p>
            <p>{{ comment['author_name'] }}</p>
            <p style="display: inline;">
            {% if comment['role'] == '0' %}
                student
            {% elif comment['role'] == '1' %}
                staff
            {% elif comment['role'] == '2' %}
                administrator
            {% elif comment['role'] == '3' %}
                admin
            {% else %}
                Unknown Role
            {% endif %}
        </p>
            <!-- Delete function for comments -->
            <form action="{{ url_for('delete_comment', post_id=post['id'], comment_id=comment['id']) }}" method="POST"
                  onsubmit="return confirm('Are you sure you want to delete this comment?');">
                <button type="submit" class="btn btn-danger btn-sm">Delete</button>
            </form>
        </div>
{% endfor %}

{% endif %}

{% endblock %}

